<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>special for u</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            background: radial-gradient(ellipse at center, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            font-family: 'Arial', sans-serif;
        }

        canvas {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
        }

        .heart-path {
            position: absolute;
            top: -9999px;
            left: -9999px;
            visibility: hidden;
        }

        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-size: 14px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .controls h3 {
            margin-bottom: 10px;
            color: #ee5282;
        }

        .controls p {
            margin: 5px 0;
            opacity: 0.8;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 1000;
        }

        .title {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: #ee5282;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            z-index: 100;
            text-shadow: 0 0 20px rgba(238, 82, 130, 0.5);
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">Loading...</div>
    
    <div class="controls">
        <h3>Controls</h3>
        <p>Mouse: Rotate view</p>
        <p>Scroll: Zoom in/out</p>
        <p>Right click + drag: Pan</p>
    </div>

    <div class="title">3D Heart Particle Animation</div>

    <!-- Hidden SVG with heart path -->
    <svg class="heart-path" width="600" height="552" viewBox="0 0 600 552">
        <path id="heart-path" d="M300,552 C200,400 0,300 0,150 C0,50 50,0 150,0 C200,0 250,25 300,75 C350,25 400,0 450,0 C550,0 600,50 600,150 C600,300 400,400 300,552 Z"/>
    </svg>

    <!-- Three.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Three.js OrbitControls -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <!-- GSAP Animation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script>
        // Wait for libraries to load
        window.addEventListener('load', function() {
            setTimeout(initAnimation, 500);
        });

        function initAnimation() {
            try {
                console.clear();
                
                // Hide loading screen
                document.getElementById('loading').style.display = 'none';

                /* SETUP */
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(
                    75,
                    window.innerWidth / window.innerHeight,
                    0.1,
                    5000
                );
                camera.position.set(0, 0, 500);

                const renderer = new THREE.WebGLRenderer({ 
                    antialias: true,
                    alpha: true 
                });
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setClearColor(0x000000, 0);
                document.body.appendChild(renderer.domElement);

                /* CONTROLS */
                const controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.enableZoom = true;
                controls.enablePan = true;
                controls.maxDistance = 1000;
                controls.minDistance = 100;

                /* PARTICLES */
                // Create a global gsap timeline that contains all tweens
                const tl = gsap.timeline({
                    repeat: -1,
                    yoyo: true
                });

                const path = document.querySelector("#heart-path");
                
                if (!path) {
                    throw new Error("Heart path not found");
                }

                const length = path.getTotalLength();
                const vertices = [];
                const colors = [];
                const sizes = [];

                // Create particles along the heart path
                for (let i = 0; i < length; i += 0.5) {
                    const point = path.getPointAtLength(i);
                    const vector = new THREE.Vector3(point.x, -point.y, 0);
                    
                    // Add some randomness for organic feel
                    vector.x += (Math.random() - 0.5) * 20;
                    vector.y += (Math.random() - 0.5) * 20;
                    vector.z += (Math.random() - 0.5) * 50;
                    
                    vertices.push(vector);

                    // Random colors around the pink/red spectrum
                    const hue = Math.random() * 0.1 + 0.9; // Red to pink
                    const saturation = 0.7 + Math.random() * 0.3;
                    const lightness = 0.5 + Math.random() * 0.3;
                    const color = new THREE.Color().setHSL(hue, saturation, lightness);
                    colors.push(color.r, color.g, color.b);

                    // Random sizes
                    sizes.push(Math.random() * 5 + 2);

                    // Create animation for each particle
                    const delay = i * 0.001;
                    const duration = 2 + Math.random() * 3;
                    
                    tl.from(vector, {
                        x: 300, // Center X of the heart
                        y: -276, // Center Y of the heart
                        z: 0,
                        ease: "power2.inOut",
                        duration: duration
                    }, delay);
                }

                // Create geometry and materials
                const geometry = new THREE.BufferGeometry().setFromPoints(vertices);
                geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
                geometry.setAttribute('size', new THREE.Float32BufferAttribute(sizes, 1));

                const material = new THREE.PointsMaterial({
                    size: 3,
                    vertexColors: true,
                    blending: THREE.AdditiveBlending,
                    transparent: true,
                    opacity: 0.8,
                    sizeAttenuation: true
                });

                const particles = new THREE.Points(geometry, material);

                // Center the particles
                particles.position.x -= 300;
                particles.position.y += 276;

                scene.add(particles);

                // Add scene rotation animation
                gsap.fromTo(scene.rotation, {
                    y: -0.3
                }, {
                    y: 0.3,
                    repeat: -1,
                    yoyo: true,
                    ease: 'power2.inOut',
                    duration: 4
                });

                // Add subtle floating animation
                gsap.fromTo(particles.position, {
                    y: particles.position.y - 20
                }, {
                    y: particles.position.y + 20,
                    repeat: -1,
                    yoyo: true,
                    ease: 'sine.inOut',
                    duration: 3
                });

                /* RENDERING */
                function render() {
                    requestAnimationFrame(render);
                    
                    // Update controls
                    controls.update();
                    
                    // Update geometry from animated vertices
                    geometry.setFromPoints(vertices);
                    geometry.attributes.position.needsUpdate = true;
                    
                    // Render the scene
                    renderer.render(scene, camera);
                }

                /* EVENTS */
                function onWindowResize() {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                }

                window.addEventListener('resize', onWindowResize, false);

                // Add mouse interaction for extra sparkle effect
                let mouseX = 0, mouseY = 0;
                
                function onMouseMove(event) {
                    mouseX = (event.clientX / window.innerWidth) * 2 - 1;
                    mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
                    
                    // Subtle camera movement based on mouse
                    gsap.to(camera.position, {
                        x: mouseX * 50,
                        y: mouseY * 50,
                        duration: 2,
                        ease: "power2.out"
                    });
                }

                window.addEventListener('mousemove', onMouseMove, false);

                // Start the rendering loop
                render();

                console.log("3D Heart Animation initialized successfully!");
                
            } catch (error) {
                console.error("Error initializing animation:", error);
                document.getElementById('loading').innerHTML = "Error loading animation. Please refresh the page.";
            }
        }

        // Handle errors
        window.addEventListener('error', function(e) {
            console.error('Script error:', e.error);
        });
    </script>
</body>
</html>

